<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: JScript | 法華経]]></title>
  <link href="http://namusyaka.github.com/blog/categories/jscript/atom.xml" rel="self"/>
  <link href="http://namusyaka.github.com/"/>
  <updated>2012-10-02T17:39:13+09:00</updated>
  <id>http://namusyaka.github.com/</id>
  <author>
    <name><![CDATA[namusyaka]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[地震の影響で電話やメールがつながりにくいですがSkypeが有効です。]]></title>
    <link href="http://namusyaka.github.com/blog/2011/03/12/github-jekyll/"/>
    <updated>2011-03-12T00:00:00+09:00</updated>
    <id>http://namusyaka.github.com/blog/2011/03/12/github-jekyll</id>
    <content type="html"><![CDATA[<p>皆さん大変ですね。
僕もなにかしてあげたいと思うんですが正直何をしたらいいか思い当たることがありません。</p>

<p>ただSkypeが有効ということで、Skype関連のツールを作ってみました。
JScriptを使っているのでWindows以外では動きません。</p>

<p><a href="http://namusyaka.info/skype_recv.html">Skypeのチャットログを自動で保存していくツールwindows用</a>です。
簡単に説明します。</p>

<ul>
<li>Skype4COMを使っている。</li>
<li>インストールが必要(ツールページ先参照)。</li>
<li>ソースは以下の通り。</li>
</ul>


<script src="https://gist.github.com/871793.js"> </script>


<p><noscript>
{% codeblock lang:javascript %}</p>

<p>var fso = new ActiveXObject("Scripting.FileSystemObject");
var skype = new ActiveXObject("Skype4COM.Skype");
var wss = new ActiveXObject("WScript.Shell");</p>

<p>function Skype_MessageStatus(msg, status) {
  var topic = "log/" + (msg.chat.Topic || "個人チャ");
  if(!fso.FolderExists(topic))</p>

<pre><code>fso.CreateFolder(topic);
</code></pre>

<p>  if(status == skype.Convert.TextToChatMessageStatus("RECEIVED") ||
  status == skype.Convert.TextToChatMessageStatus("SENT")) {</p>

<pre><code>try {
  var date = new Date(msg.Timestamp);
  var today = fso.OpenTextFile(topic + "/" + date.getFullYear() + date.getMonth() + date.getDate() + ".txt", 8, true, 0);
  today.WriteLine(msg.FromDisplayName + " -&gt; " + msg.body + " &lt;" + date.getHours() + ":" + date.getMinutes() + "&gt;");
} catch(e) {
  today.WriteLine(e);
} finally {
  today.close();
}
</code></pre>

<p>  }
}</p>

<p>if(!fso.FolderExists("log"))
  fso.CreateFolder("log");
WScript.ConnectObject(skype, "Skype_");
skype.Attach();</p>

<p>wss.popup("ログ受信を終了する場合はOKを押してください。");
skype = wss = null;</p>

<p>{% endcodeblock %}</p>

<p></noscript></p>

<p>とりあえず僕もなにか役に立ちたいので、被災者のためにコードを書いていて手伝ってほしいという人がいれば遠慮なく言ってください。</p>
]]></content>
  </entry>
  
</feed>
